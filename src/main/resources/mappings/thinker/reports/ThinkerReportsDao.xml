<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qdch.portal.thinker.reports.dao.ThinkerReportsDao">
    
	<sql id="thinkerReportsColumns">
		a.id AS "id",
		a.system_name AS "systemName",
		a.link AS "link",
		a.open_type AS "openType",
		a.name AS "name",
		a.types AS "types",
		a.path AS "path",
		a.url AS "url",
		a.category1 AS "category1",
		a.category2 AS "category2",
		a.category3 AS "category3",
		a.dimension AS "dimension",
		a.tags AS "tags",
		a.create_by AS "createBy.id",
		a.create_date AS "createDate",
		a.update_by AS "updateBy.id",
		a.update_date AS "updateDate",
		a.remarks AS "remarks",
		a.del_flag AS "delFlag"
	</sql>
	
	<sql id="thinkerReportsJoins">
	</sql>
    
	<select id="get" resultType="ThinkerReports">
		SELECT 
			<include refid="thinkerReportsColumns"/>
		FROM 1169_thinker_reports a
		<include refid="thinkerReportsJoins"/>
		WHERE a.id = #{id}
	</select>
	
	<select id="findList" resultType="ThinkerReports">
		SELECT 
			<include refid="thinkerReportsColumns"/>
		FROM 1169_thinker_reports a
		<include refid="thinkerReportsJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
			<if test="name != null and name != ''">
				AND a.name LIKE 
					<if test="dbName == 'oracle'">'%'||#{name}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{name}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{name},'%')</if>
			</if>
			<if test="category1 != null and category1 != ''">
				AND a.category1 LIKE 
					<if test="dbName == 'oracle'">'%'||#{category1}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{category1}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{category1},'%')</if>
			</if>
			<if test="category2 != null and category2 != ''">
				AND a.category2 LIKE 
					<if test="dbName == 'oracle'">'%'||#{category2}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{category2}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{category2},'%')</if>
			</if>
			<if test="category3 != null and category3 != ''">
				AND a.category3 LIKE 
					<if test="dbName == 'oracle'">'%'||#{category3}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{category3}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{category3},'%')</if>
			</if>
			<if test="dimension != null and dimension != ''">
				AND a.dimension LIKE 
					<if test="dbName == 'oracle'">'%'||#{dimension}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{dimension}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{dimension},'%')</if>
			</if>
			<if test="tags != null and tags != ''">
				AND a.tags LIKE 
					<if test="dbName == 'oracle'">'%'||#{tags}||'%'</if>
					<if test="dbName == 'mssql'">'%'+#{tags}+'%'</if>
					<if test="dbName == 'mysql'">concat('%',#{tags},'%')</if>
			</if>
		</where>
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<select id="findAllList" resultType="ThinkerReports">
		SELECT 
			<include refid="thinkerReportsColumns"/>
		FROM 1169_thinker_reports a
		<include refid="thinkerReportsJoins"/>
		<where>
			a.del_flag = #{DEL_FLAG_NORMAL}
		</where>		
		<choose>
			<when test="page !=null and page.orderBy != null and page.orderBy != ''">
				ORDER BY ${page.orderBy}
			</when>
			<otherwise>
				ORDER BY a.update_date DESC
			</otherwise>
		</choose>
	</select>
	
	<insert id="insert">
		INSERT INTO 1169_thinker_reports(
			id,
			system_name,
			link,
			open_type,
			name,
			types,
			path,
			url,
			category1,
			category2,
			category3,
			dimension,
			tags,
			create_by,
			create_date,
			update_by,
			update_date,
			remarks,
			del_flag
		) VALUES (
			#{id},
			#{systemName},
			#{link},
			#{openType},
			#{name},
			#{types},
			#{path},
			#{url},
			#{category1},
			#{category2},
			#{category3},
			#{dimension},
			#{tags},
			#{createBy.id},
			#{createDate},
			#{updateBy.id},
			#{updateDate},
			#{remarks},
			#{delFlag}
		)
	</insert>
	
	<update id="update">
		UPDATE 1169_thinker_reports SET 	
			system_name = #{systemName},
			link = #{link},
			open_type = #{openType},
			name = #{name},
			types = #{types},
			path = #{path},
			url = #{url},
			category1 = #{category1},
			category2 = #{category2},
			category3 = #{category3},
			dimension = #{dimension},
			tags = #{tags},
			update_by = #{updateBy.id},
			update_date = #{updateDate},
			remarks = #{remarks}
		WHERE id = #{id}
	</update>
	
	<update id="delete">
		UPDATE 1169_thinker_reports SET 
			del_flag = #{DEL_FLAG_DELETE}
		WHERE id = #{id}
	</update>
	
</mapper>