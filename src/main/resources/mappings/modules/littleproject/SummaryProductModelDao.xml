<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.qdch.portal.littleproject.dao.SummaryProductModelDao">
	<select id="getProductClassRatio" resultType="java.util.LinkedHashMap">
		SELECT T.WAREKINDID
		AS CPDLBM,
		L.MEMO AS CPDLMC,
		L.WAREKINDALIAS AS CPDLINFO,
		COUNT(1) AS CPSL
		FROM LAKE_ZD_TB_REG_WARE T
		LEFT JOIN LAKE_ZD_TB_REG_WAREKIND L
		ON T.WAREKINDID=L.WAREKINDID
		AND T.SYSID=L.SYSID
		GROUP BY T.WAREKINDID,L.WAREKINDALIAS,L.MEMO
		ORDER BY WAREKINDALIAS
	</select>

	<select id="getProductDetail" parameterType="Map"
		resultType="java.util.LinkedHashMap">
		SELECT
		T.CPMC,
		T.CPDM,
		T.KSJYR,
		T.CSJ,
		T.RKSL,
		'-' AS JDJG,
		T.CCJG AS
		CCJG,
		T.BJFS,
		T.MSDYDWL,
		T.JYMS,
		'-' AS SRZDF,
		'-' AS SRHZDF
		FROM
		HUB_TQS_CPXX T
		LEFT JOIN
		LAKE_ZD_TB_REG_WARE T1
		ON T.CPDM=T1.WAREID
		AND
		T.CPMC=T1.WARENAME
		LEFT
		JOIN LAKE_ZD_TB_REG_WAREKIND T2
		ON
		T2.WAREKINDID=T1.WAREKINDID
		AND T2.SYSID=T1.SYSID
		WHERE
		T2.WAREKINDID=#{productClassNo}
		AND T.CPDM=#{productCode}
	</select>

	<select id="getProductClassAndName" resultType="java.util.LinkedHashMap">
		SELECT DISTINCT
		T1.WAREKINDID AS CPLB,
		T2.WAREKINDALIAS AS CPDLINFO,
		T.CPMC,
		T.CPDM
		FROM
		HUB_TQS_CPXX T
		LEFT JOIN LAKE_ZD_TB_REG_WARE T1
		ON T.CPDM=T1.WAREID
		AND
		T.CPMC=T1.WARENAME
		LEFT JOIN LAKE_ZD_TB_REG_WAREKIND T2
		ON
		T2.WAREKINDID=T1.WAREKINDID AND T2.SYSID=T1.SYSID order by
		T1.WAREKINDID
	</select>

	<select id="getProductPriceTrend" parameterType="Map"
		resultType="java.util.LinkedHashMap">
		SELECT T.VDAY,
		T.JYS,
		T2.WAREKINDID AS CPDLBM,
		T2.MEMO AS
		CPDLMC,
		T2.WAREKINDALIAS CPDLINFO,
		T.CPBM,
		T.CPMC,
		T.FVALUE
		FROM
		INSIGHT_SETTLEMENT_PRICE T
		LEFT JOIN LAKE_ZD_TB_REG_WARE T1
		ON
		T.CPBM=T1.WAREID
		AND T.CPMC=T1.WARENAME
		LEFT JOIN
		LAKE_ZD_TB_REG_WAREKIND T2
		ON T1.WAREKINDID=T2.WAREKINDID
		AND
		T1.SYSID=T2.SYSID
		WHERE T.JYSFL=1
		AND T.VDAY>= (SELECT
		TO_CHAR(TO_DATE(MAX(VDAY),'YYYYMMDD')-INTERVAL'15
		DAY','YYYYMMDD') FROM
		INSIGHT_SETTLEMENT_PRICE)
		AND T.VDAY &lt; (SELECT MAX(VDAY) FROM
		INSIGHT_SETTLEMENT_PRICE)
		AND
		T2.WAREKINDID = #{productClassNo}
		AND
		T.CPBM=#{productCode}
		ORDER BY
		T.VDAY
	</select>
</mapper>